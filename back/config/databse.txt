DROP DATABASE IF EXISTS Tempo_de_florescer;
CREATE DATABASE Tempo_de_florescer;
USE Tempo_de_florescer;

CREATE TABLE voluntario (
    id_voluntario INT AUTO_INCREMENT PRIMARY KEY,
    nome VARCHAR(100) NOT NULL,
    email VARCHAR(100) UNIQUE NOT NULL,
    senha VARCHAR(255) NOT NULL,
    telefone VARCHAR(15),
    data_nascimento DATE NOT NULL,
    endereco VARCHAR(100) NOT NULL,
    data_inscricao TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
CREATE TABLE perfil (
    id_perfil INT AUTO_INCREMENT PRIMARY KEY,
    id_voluntario INT NOT NULL,
    bio TEXT,
    data_criacao TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

    FOREIGN KEY (id_voluntario)
        REFERENCES voluntario(id_voluntario)
        ON DELETE CASCADE
);

CREATE TABLE empresas (
id_empresa INT AUTO_INCREMENT PRIMARY KEY,
nome_empresa VARCHAR(100) NOT NULL,
cnpj INT,
endereço_comercial VARCHAR(100) NOT NULL,
telefone VARCHAR (15),
email VARCHAR(100) UNIQUE NOT NULL,
senha VARCHAR(100) NOT NULL
);

CREATE TABLE administrador (
    id_administrador INT AUTO_INCREMENT PRIMARY KEY,
    nome VARCHAR(100) NOT NULL,
    email VARCHAR(100) UNIQUE NOT NULL,
    senha VARCHAR(255) NOT NULL,
    telefone VARCHAR(15)
);

CREATE TABLE tipo_pagamento (
    id_tipo_pagamento INT AUTO_INCREMENT PRIMARY KEY,
    metodo VARCHAR(50) NOT NULL -- Pix, Cartão de Crédito, Boleto
);

CREATE TABLE pagamento (
    id_pagamento INT AUTO_INCREMENT PRIMARY KEY,
    id_tipo_pagamento INT NOT NULL,
    pix_qrcode BLOB,
    pix_chave VARCHAR(200),
    cartao_numero_mascarado VARCHAR(20),
    cartao_nome VARCHAR(100),
    boleto_codigo VARCHAR(100),
    FOREIGN KEY (id_tipo_pagamento) REFERENCES tipo_pagamento(id_tipo_pagamento)
);

CREATE TABLE doacao (
    id_doacao INT AUTO_INCREMENT PRIMARY KEY,
    nome VARCHAR(100) NOT NULL,
    email VARCHAR(100) NOT NULL,
    telefone VARCHAR(15),
    data_nascimento DATE NOT NULL,
    sexo ENUM('Masculino', 'Feminino', 'Outro'),
    como_ficou_sabendo VARCHAR(255),
    valor_doacao DECIMAL(10,2) NOT NULL,
    id_pagamento INT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (id_pagamento) REFERENCES pagamento(id_pagamento)
);

CREATE TABLE contato (
    id_contato INT AUTO_INCREMENT PRIMARY KEY,
    nome VARCHAR(100) NOT NULL,
    sobrenome VARCHAR(100) NOT NULL,
    email VARCHAR(100) NOT NULL,
    mensagem TEXT NOT NULL,
    data_envio TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);